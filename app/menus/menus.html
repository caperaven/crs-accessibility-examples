<article>
    <section>
        <h2>How to define menus</h2>
        <p>
            A <a href="https://www.w3.org/TR/wai-aria-1.1/#menu" target="_blank">menu</a> offers a list of choices to the user such as a set of actions/functions.
            A menu is usually opened or made visible via a <a href="https://www.w3.org/TR/wai-aria-practices/#menubutton" target="_blank">menu button</a>,
            choosing an item in a menu opening a sub menu, or by command such as shift + F10 (which
            usually opens a context menu). When a user activates a choice in a menu, the menu usually closes unless the choice
            opens a sub menu.
        </p>
        <p>
            There are a number of different types of menus, some of which will be discussed below:
        </p>
        <ul>
            <li>
                A menu that is visually persistent is a <a href="https://www.w3.org/TR/wai-aria-1.1/#menubar" target="_blank">menubar</a>.
                It is usually horizontal and offers the user quick access to a consistent set of commands.
            </li>
            <li>
                Navigational menus are often used within headers/footers. They provide condensed site navigation functionality.
                They will often have sub-menu's that are opened via sub menu items.
            </li>
            <li>
                Fly-out or drop-down menus provide an overview of a web sites page hierarchy. Application menus are usually implemented
                in this way. Note however that people with reduced dexterity, such as tremors, often have trouble operating fly-out menus.

            </li>
        </ul>
        <p>Included below is an example of a menubar with two drop-down menus embedded:</p>
        <html-to-text src="/templates/menu-bar-example.html"></html-to-text>
        <p>
            Breakdown of the example:
        </p>
        <ul>
            <li>
                The #menubar ul:
                <ul>
                    <li>
                        <a href="https://www.w3.org/TR/wai-aria-1.1/#menubar" target="_blank">role="menubar"</a> identifies the element as a menubar container for a set of menuitem elements.
                    </li>
                    <li>
                        It should not be focusable as focus is managed using <a href="https://www.w3.org/TR/wai-aria-practices/#kbd_roving_tabindex" target="_blank">roving tabindex</a>.
                    </li>
                    <li>
                        <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-label" target="_blank">aria-label</a> in order to provide an accessible name, helping assistive technology users understand the purpose of the menubar and
                        distinguish it from other menubars or similar elements
                    </li>
                </ul>
            </li>
            <li>
                The second level li's
                <ul>
                    <li>
                        Has <a href="https://www.w3.org/TR/wai-aria-1.1/#none" target="_blank">role="none"</a> which removes the implied listitem role of the li element.
                    </li>
                    <li>
                        These li's will contain <a href="https://www.w3.org/TR/wai-aria-1.1/#menuitem" target="_blank">menuitems</a> in the form of anchor tags or buttons.
                    </li>
                </ul>
            </li>
            <li>
                The #menu_item_link anchor tag
                <ul>
                    <li>
                        The anchor tag is acting as the menuitem by having <a href="https://www.w3.org/TR/wai-aria-1.1/#menuitem" target="_blank">role="menuitem"</a>.
                    </li>
                    <li>
                        <a href="https://webaim.org/techniques/keyboard/tabindex" target="_blank">tabindex="0"</a> so that the element can be placed within the tab order
                    </li>
                    <li>
                        <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-haspopup" target="_blank">aria-haspopup="true"</a> because the element activates a sub-menu of items
                    </li>
                    <li>
                        <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-expanded" target="_blank">aria-expanded</a> is initially set to false, but will be toggled when the associated sub menu is opened/closed
                    </li>
                </ul>
            </li>
            <li>
                The associated drop down submenu
                <ul>
                    <li>
                        Has <a href="https://www.w3.org/TR/wai-aria-1.1/#menu" target="_blank">role="menu"</a> as it is acting as a menu with a set of menu items
                    </li>
                    <li>
                        <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-label" target="_blank">aria-label="First Drop Down Menu"</a> defining the accessibility name for the menu
                    </li>
                </ul>
            </li>
            <li>
                Nested li's under the first drop down menu
                <ul>
                    <li>
                        Similar to the second li's mentioned above, they have <a href="https://www.w3.org/TR/wai-aria-1.1/#none" target="_blank">role="none"</a> which removes the implied listitem role of the li element.
                        This is important as the parent ul is serving as a menu, so the li elements are not in their required list context
                    </li>
                </ul>
            </li>
            <li>
                The 5th level nested anchor tags acting as menu items
                <ul>
                    <li>
                        Within the li's mentioned just above are the anchor tags with <a href="https://www.w3.org/TR/wai-aria-1.1/#menuitem" target="_blank">role="menuitem"</a> identifying the anchor tags as menu items.
                    </li>
                    <li>
                        The accessible name is calculated from the text content of the element
                    </li>
                    <li>
                        Tabindex="-1" keeps the element focusable but removes it from the tab index.
                    </li>
                    <li>
                        If the anchor tag is associated with another dropdown menu it will have the same <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-haspopup" target="_blank">aria-haspopup</a> and <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-expanded" target="_blank">aria-expanded</a>
                        as the #menu_item_link anchor tag above
                    </li>
                </ul>
            </li>
            <li>
                The #menu_item_button button
                <ul>
                    <li>
                        This element is acting as a <a href="https://www.w3.org/TR/wai-aria-1.1/#menuitem" target="_blank">menuitem</a> with an associated dropdown menu of radio menu items.
                    </li>
                    <li>
                        Has <a href="https://www.w3.org/TR/wai-aria-1.1/#menuitem" target="_blank">role="menuitem"</a> to identify the element as a menuitem
                    </li>
                    <li>
                        The accessible name comes from the button's text content
                    </li>
                    <li>
                        Has <a href="https://webaim.org/techniques/keyboard/tabindex" target="_blank">tabindex="-1"</a> as the #menu_item_link anchor tag has initial focus, but if this menu item
                        is focused via keyboard input (directional arrow keys) then the tabindex will update to 0
                    </li>
                    <lI>
                        Has <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-haspopup" target="_blank">aria-haspopup="true"</a> to reflect the associated drop down submenu
                    </lI>
                    <li>
                        <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-expanded" target="_blank">Aria-expanded</a> will be toggled true/false when the submenu is opened/closed
                    </li>
                </ul>
            </li>
            <li>
                The associated dropdown menu using ul
                <ul>
                    <li>
                        has <a href="https://www.w3.org/TR/wai-aria-1.1/#menu" target="_blank">role="menu"</a> to identify the element as a menu container for a set of menu items
                    </li>
                    <li>
                        <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-label" target="_blank">Aria-label</a>="Second Drop Down Menu" represents the accessible name for the menu
                    </li>
                </ul>
            </li>
            <li>
                The three li radio menu items within the dropdown
                <ul>
                    <li>
                        These li's are acting as a radio group as defined by their <a href="https://www.w3.org/TR/wai-aria-1.1/#menuitemradio" target="_blank">role="menuitemradio"</a>
                    </li>
                    <li>
                        Their accessible name is computed from the text content within the li
                    </li>
                    <li>
                        tabindex is set to "-1" in order to make them focusable but not within the tab sequence
                    </li>
                    <li>
                        The <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-checked" target="_blank">aria-checked</a>="true" indicates the menuitemradio is checked. The visual appearance of the selected state is synched with the aria-checked value using <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Attribute_selectors" target="_blank">CSS attribute selectors</a>.
                    </li>
                    <li>
                        The aria-checked="false" indicates the menuitemradio is not checked.
                    </li>
                </ul>
            </li>
        </ul>
    </section>
    <section>
        <h2>Keyboard Interaction</h2>
        <p>
            The following keyboard interaction description assumes:
        </p>
        <ul>
            <li>
                A horizontal menubar containing several menuitem elements
            </li>
            <li>
                All items in the menubar have child submenus that contain multiple vertically arranged items
            </li>
            <li>
                Some of the menuitem elements in the submenus have child submenus with items that are also vertically arranged
            </li>
        </ul>
        <p>
            Also note the following:
        </p>
        <ul>
            <li>
                Focusable elements, which may have role menuitem, menuitemradio, or menuitemcheckbox, are referred to as items
            </li>
            <li>
                If a behaviour applies to only certain types of items, e.g. menuitem elements, the specific role name will be used.
            </li>
            <li>
                Submenus, also known as pop-up menus, are elements with role menu.
            </li>
            <Li>
                Except where noted, menus opened from a menubutton behave the same as menus opened from a menubar.
            </Li>
        </ul>
        <p>
            Keyboard interaction for menu and menubars is as follows:
        </p>
        <ul>
            <li>
                Enter:
                <ul>
                    <li>
                        When focus is on a menuitem that has a submenu, opens the submenu and places focus on its first item.
                    </li>
                    <li>
                        Otherwise, actives the item and closes the menu.
                    </li>
                </ul>
            </li>
            <li>
                Space (Optional):
                <ul>
                    <li>
                        When focus is on a menuitemcheckbox, changes the state without closing the menu
                    </li>
                    <li>
                        When focus is on a menuitemradio that is not checked, without closing the menu, checks the focused menuitemradio and unchecks any other checked menuitemradio element in the same group.
                    </li>
                    <li>
                        When focus is on a menuitem that has a submenu, opens the submenu and places focus on its first item.
                    </li>
                    <li>
                        When focus is on a menu item that does not have a submenu, activates the menuitem and closes the menu.
                    </li>
                </ul>
            </li>
            <li>
                Down Arrow:
                <ul>
                    <li>
                        When focus is on a menuitem in a menubar, opens its submenu and places focus on the first item in the submenu.
                    </li>
                    <li>
                        When focus is in a menu, moves focus to the next item, optionally wrapping from the last to the first
                    </li>
                </ul>
            </li>
            <li>
                Up Arrow:
                <ul>
                    <li>
                        When focus is in a menu, moves focus to the previous item, optionally wrapping from the first to the last.
                    </li>
                    <li>
                        (Optional) When focus is on a menuitem in a menubar, opens its submenu and places focus on the last item in the submenu
                    </li>
                </ul>
            </li>
            <li>
                Right Arrow:
                <ul>
                    <li>
                        When focus is in a menubar, moves focus to the previous item, optionally wrapping from the first to the last.
                    </li>
                    <li>
                        When focus is in a menu and on a menuitem that has a submenu, opens the submenu and places focus on its first item.
                    </li>
                    <li>
                        When focus is in a menu and on an item that does not have a submenu, performs the following 3 actions:
                        <ol>
                            <li>
                                Closes the submenu and any parent menus.
                            </li>
                            <li>
                                Moves focus to the next menuitem in the menubar.
                            </li>
                            <li>
                                Either opens the submenu of that menuitem without moving focus into the submenu, or opens the submenu of that menuitem and places focus on the first item in the submenu
                            </li>
                        </ol>
                    </li>
                    <li>
                        NOTE: If the menubar were not present, e.g. the menus were opened from a menubutton, Right Arrow would not do anything when focus is on an item that does not have a submenu.
                    </li>
                </ul>
            </li>
            <li>
                Left Arrow:
                <ul>
                    <li>
                        When focus is in a menubar, moves focus to the previous item, optionally wrapping from first to last.
                    </li>
                    <li>
                        When focus is in a submenu of an item in a menu, closes the submenu and returns focus to the parent menuitem.
                    </li>
                    <li>
                        When focus is in a submenu of an item in a menubar, performs the following 3 actions:
                        <ol>
                            <ul>
                                Closes the submenu
                            </ul>
                            <li>
                                Moves focus to the previous menuitem in the menubar
                            </li>
                            <li>
                                Either opens the submenu of the menuitem without moving focus into the submenu, or opens the submenu of that menuitem and places focus on the first item in the submenu
                            </li>
                        </ol>
                    </li>
                </ul>
            </li>
            <li>
                Home: If arrow key wrapping is not supported, moves focus to the first item in the current menu or menubar
            </li>
            <li>
                End: If arrow key wrapping is not supported, moves focus to the last item in the current menu or menubar
            </li>
            <li>
                (Optional) Any key that corresponds to a printable character: Moves focus to the next menuitem in the current menu whose label begins with that printable character
            </li>
            <li>
                Escape: Close the menu that contains focus and return focus to the element or context, e.g. menu button or parent menuitem from which the menu was opened.
            </li>
            <li>
                Tab: Moves focus to the next element in the tab sequence, and if the item that had focus is not in a menubar, closes its menu and all open parent menu containers.
            </li>
            <li>
                Shift + Tab: Moves focus to the previous element in the tab sequence, and if the item that had focus is not in a menubar, closes its menu and all open parent menu containers.
            </li>
        </ul>
    </section>
    <section>
        <h2>WAI-ARIA Roles, States & Properties</h2>
        <ul>
            <li>
                A menu is a container of items that represent choices. The element serving as the menu has a role of either
                <a href="https://www.w3.org/TR/wai-aria-1.1/#menu" target="_blank">menu</a> or <a href="https://www.w3.org/TR/wai-aria-1.1/#menubar" target="_blank">menubar</a>
            </li>
            <li>
                The items contained in a menu are child elements of the containing menu or menubar and have any of the following roles:
                <uL>
                    <li><a href="https://www.w3.org/TR/wai-aria-1.1/#menuitem" target="_blank">menuitem</a></li>
                    <li><a href="https://www.w3.org/TR/wai-aria-1.1/#menuitemcheckbox" target="_blank">menuitemcheckbox</a></li>
                    <li><a href="https://www.w3.org/TR/wai-aria-1.1/#menuitemradio" target="_blank">menuitemradio</a></li>
                </uL>
            </li>
            <li>
                If activating a <a href="https://www.w3.org/TR/wai-aria-1.1/#menuitem" target="_blank">menuitem</a> opens a submenu, the menuitem is known as a parent menuitem. A submenu's menu element is:
                <ul>
                    <li>Contained inside the same menu element as its parent menuitem</li>
                    <li>Is the sibling element immediately following its parent menuitem</li>
                </ul>
            </li>
            <li>
                A parent menuitem has <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-haspopup" target="_blank">aria-haspopup</a> set to either menu or true
            </li>
            <li>
                A parent menuitem has <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-expanded" target="_blank">aria-expanded</a> set to false when its child menu is not visible and set tot true when the child menu is visible
            </li>
            <li>
                One of the following approaches is used to enable scripts to move focus among items in a menu as described in <a href="https://www.w3.org/TR/wai-aria-practices/#kbd_general_within" target="_blank">Keyboard Navigation Inside Components</a>:
                <ul>
                    <li>
                        The menu container has tabindex set to -1 or 0 and <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-activedescendant" target="_blank">aria-activedescendant</a> set to the ID of the focused item
                    </li>
                    <li>
                        Each item in the menu has tabindex set to -1, except in a menubar, where the first item has tabindex set to 0
                    </li>
                </ul>
            </li>
            <li>
                When a <a href="https://www.w3.org/TR/wai-aria-1.1/#menuitemcheckbox" target="_blank">menuitemcheckbox</a> or <a href="https://www.w3.org/TR/wai-aria-1.1/#menuitemradio" target="_blank">menuitemradio</a> is checked, <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-checked" target="_blank">aria-checked</a> is set to true
            </li>
            <li>
                When a menu item is disabled, <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-disabled" target="_blank">aria-disabled</a> is set to true
            </li>
            <li>
                Items in a menu may be divided into groups by placing an element with a role of <a href="https://www.w3.org/TR/wai-aria-1.1/#separator" target="_blank">separator</a> between groups
            </li>
            <li>
                All <a href="https://www.w3.org/TR/wai-aria-1.1/#separator" target="_blank">separators</a> should have <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-orientation" target="_blank">aria-orientation</a> consistent with the separator's orientation
            </li>
            <li>
                If a menubar has a visible label, the element with role menubar has <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-labelledby" target="_blank">aria-labelledby</a> set to a value that refers to the labelling element.
                Otherwise the menubar element has a label provided by <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-label" target="_blank">aria-label</a>
            </li>
            <li>
                If a menubar is vertically oriented, it has <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-orientation" target="_blank">aria-orientation</a> set to vertical
            </li>
            <li>
                An element with role menu either has:
                <ul>
                    <li>
                        <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-labelledby" target="_blank">aria-labelledby</a> set to a value that refers to the menuitem or button that controls its display.
                    </li>
                    <li>
                        A label provided by <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-label" target="_blank">aria-label</a>
                    </li>
                </ul>
            </li>
            <lI>
                If a menu is horizontally oriented, it has <a href="https://www.w3.org/TR/wai-aria-1.1/#aria-orientation" target="_blank">aria-orientation</a> set to horizontal. The default value of aria-orientation for a menu is vertical
            </lI>
        </ul>
    </section>
    <section>
        <h2>Reference</h2>
        <nav aria-labelledby="references">
            <ul>
                <li>
                    Visit the <a href="https://www.w3.org/TR/wai-aria-practices/#menu" target="_blank">WAI-ARIA Authoring Practices 1.1</a> to read up more on implementing accessible menus and menubars.
                </li>
                <li>
                    For more info on different menu implementations, visit the <a href="https://www.w3.org/WAI/tutorials/menus/" target="_blank">W3 Web Accessibility Tutorials</a> on menu concepts.
                </li>
            </ul>
        </nav>
    </section>
    <section>
        <h2>Examples</h2>
        <nav aria-labelledby="examples">
            <ul>
                <li><a href="https://github.com/caperaven/crs-accessibility-examples/blob/master/templates/menu-bar-example.html" target="_blank">Menu Bar Example</a></li>
                <li><a href="https://www.w3.org/TR/wai-aria-practices/examples/menubar/menubar-1/menubar-1.html" target="_blank">Implemented Navigational Menubar Example</a></li>
                <li><a href="https://www.w3.org/TR/wai-aria-practices/examples/menubar/menubar-2/menubar-2.html" target="_blank">Implemented Editor Menubar Example</a></li>
            </ul>
        </nav>
    </section>
</article>